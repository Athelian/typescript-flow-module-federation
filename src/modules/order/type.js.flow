// @flow
import type { BatchCreate } from 'modules/batch/type.js.flow';
import type { Tag } from 'modules/tags/type.js.flow';

type Batch = {
  id: string,
};

type ProductProvider = {
  id: string,
  product: {
    id: string,
    name: string,
    serial: string,
    tags?: Array<Tag>,
  },
  unitPrice: {
    amount: number,
    currency: string,
  },
  supplier: {
    name: string,
  },
};

export type OrderItem = {
  id: string,
  sort: number,
  quantity: number,
  price: {
    amount: number,
    currency: string,
  },
  batches: Batch,
  productProvider: ProductProvider,
};

export type Order = {
  id: string,
  PO: string,
  date: ?Date,
  exporter: {
    name: string,
  },
  batchedQuantity: number,
  shippedQuantity: number,
  updatedAt: string | Date,
  createdAt: string | Date,
  orderItems: Array<OrderItem>,
};

export type SelectableOrderItem = {
  id: string,
  quantity: number,
  price: number,
  order: {
    PO: string,
    currency: string,
    exporter: {
      id: string,
    },
  },
  batchItems: Array<{
    no: string,
    quantity: number,
  }>,
};

export type OrderItemForm = {
  quantity?: number,
  price?: number,
  batches: Array<BatchCreate>,
  productProviderId: string,
};

export type OrderForm = {
  poNo: string,
  exporterId: string,
  currency: string,
  issuedAt?: ?Date,
  piNo?: ?string,
  incoterm?: ?string,
  deliveryPlace?: ?string,
  memo?: ?string,
  orderItems?: Array<OrderItemForm>,
};
